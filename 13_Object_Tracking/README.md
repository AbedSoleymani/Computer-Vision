# Object Tracking
Object tracking enables machines to follow and understand the motion of objects in video streams. This repository focuses on a state-of-the-art object tracking method, namely DeepSORT, which combines traditional tracking techniques with deep learning for improved accuracy and speed.

## Historical Context
Mean-shift and optical flow are traditional object tracking methods. However, they face challenges such as high computational complexity, sensitivity to noise, and tracking loss during occlusion. These limitations led to the evolution of more advanced tracking algorithms.

Kalman Filter in SORT
Kalman Filter plays a key role in the SORT (Simple Online and Realtime Tracking) algorithm. In the estimation stage, the Kalman filter employs a linear velocity model with a state vector that includes components like position, scale, and aspect ratio. This helps to predict the object's state at each frame.

## SORT: Four Stages
1. Detection: In the detection stage, the algorithm receives object bounding boxes from a detection module. To refine these detections, the Kalman filter is employed. The state vector, $x$, includes various elements representing the object's characteristics. Mathematically, the update process can be expressed as:

$$
x_k = F \cdot x_{k-1} + B \cdot u_k + w_k
$$

Where:
- $x_k$ is the state vector at time $k$,
- $F$ is the state transition matrix,
- $B$ is the control-input matrix,
- $u_k$ is the control vector (which could represent the acceleration),
- $w_k$ is the process noise.

The state vector ($x$) typically includes components such as:
- $u$ and $v$: Horizontal and vertical pixel locations of the target center.
- $s$: Scale - area of the target's bounding box.
- $r$: Aspect ratio - the ratio of width to height.
- $\dot{u}$, $\dot{v}$, $\dot{s}$: Velocities corresponding to $u$, $v$, and $s$.

2. Estimation: The Kalman filter aids in estimating the state of the tracked object. Given the observed measurements, the Kalman gain ($K_k$) is calculated to weigh the difference between the predicted state ($\hat{x}_k^-$) and the measurement ($z_k$). Mathematically, the estimation is represented as:

$$
\hat{x}_k = \hat{x}_k^- + K_k \cdot (z_k - H \cdot \hat{x}_k^-)
$$

Where:
- $\hat{x}_k^-$ is the predicted state,
- $H$ is the observation matrix.

3. Association: Target association involves linking the current frame's detections to existing tracks. This is achieved by computing the assignment cost matrix using the Intersection over Union (IoU) between bounding boxes. The Hungarian algorithm optimally matches detections to tracks, minimizing the total cost.

**Hungarian Algorithm:**
The Hungarian algorithm solves the assignment problem by finding the optimal assignment that minimizes the total cost. Given the cost matrix (association cost between tracks and detections), the algorithm efficiently determines the optimal assignment, ensuring each track is linked to the most likely detection.

4. Track Identity Lifecycle: The track identity lifecycle involves track initialization, handling uncertainties, and managing lost frames. The state vector elements, such as velocities, provide information crucial for predicting the object's future state. Tracks undergo a probationary period to accumulate evidence. Tracks are terminated if they are not detected for a certain number of frames (Threshold for Track Lost - TLost). Reappearing objects resume tracking under new identities.

These stages collectively form the SORT algorithm, providing a comprehensive framework for online and real-time object tracking.

## DeepSORT Integration
To enhance tracking performance, DeepSORT introduces a distance metric based on object appearance. The appearance descriptor, generated by a dense layer, enables nearest neighbor queries for visual similarity, contributing to robust tracking.

DeepSORT Advantages
DeepSORT excels in terms of:

Speed: It is one of the fastest object tracking methods.
Accuracy: DeepSORT delivers high tracking accuracy.
Occlusion Handling: It effectively manages tracking during occlusion scenarios.